{"version":3,"file":"attempt.mjs","sources":["../../../../../../../../../../node_modules/.pnpm/@xan105+error@1.7.1/node_modules/@xan105/error/lib/attempt.js"],"sourcesContent":["/*\nCopyright (c) Anthony Beaumont\nThis source code is licensed under the MIT License\nfound in the LICENSE file in the root directory of this source tree.\n*/\n\nfunction attempt(fn, args){\n if (!Array.isArray(args)) args = [];\n\n try{\n    //Can only determine if a function returns a Promise after exec. it\n    const handle = typeof fn === \"function\" ? fn(...args) : fn;\n    if (Object.prototype.toString.call(handle) === \"[object Promise]\" && typeof handle.then === \"function\")\n    {\n     //Attach handlers fast enough to avoid rejection was handled asynchronously\n     return new Promise((resolve) => {\n       handle\n       .then((result) => { \n         return resolve([result, undefined]);\n       })\n       .catch((err) => { \n         return resolve([undefined, err]); \n       })\n     });\n    } \n    else { \n      const result = handle;\n      return [result, undefined];\n    }\n  }catch(err){\n    return [undefined, err]\n  }\n}\n//NB: return undefined because destructure default assignement triggers only with undefined\n//eg: const [ foo = \"bar\", value ] = source;\n\n//\"node:util promisify\" style syntax: attemptify(foo)(bar) instead of attempt(foo, [bar]);\nfunction attemptify(fn){\n  return function(...args){\n    return attempt(fn, args);\n  }\n}\n\nexport { attempt, attemptify };"],"names":["attempt","fn","args","handle","resolve","result","err","attemptify"],"mappings":"AAMA,SAASA,EAAQC,GAAIC,GAAK;AACzB,EAAK,MAAM,QAAQA,CAAI,MAAGA,IAAO,CAAA;AAEjC,MAAG;AAEA,UAAMC,IAAS,OAAOF,KAAO,aAAaA,EAAG,GAAGC,CAAI,IAAID;AACxD,WAAI,OAAO,UAAU,SAAS,KAAKE,CAAM,MAAM,sBAAsB,OAAOA,EAAO,QAAS,aAGpF,IAAI,QAAQ,CAACC,MAAY;AAC9B,MAAAD,EACC,KAAK,CAACE,MACED,EAAQ,CAACC,GAAQ,MAAS,CAAC,CACnC,EACA,MAAM,CAACC,MACCF,EAAQ,CAAC,QAAWE,CAAG,CAAC,CAChC;AAAA,IACH,CAAC,IAIO,CADQH,GACC,MAAS;AAAA,EAE7B,SAAOG,GAAI;AACT,WAAO,CAAC,QAAWA,CAAG;AAAA,EACxB;AACF;AAKA,SAASC,EAAWN,GAAG;AACrB,SAAO,YAAYC,GAAK;AACtB,WAAOF,EAAQC,GAAIC,CAAI;AAAA,EACzB;AACF;","x_google_ignoreList":[0]}