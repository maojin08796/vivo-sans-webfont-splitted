{"version":3,"file":"index.js","sources":["../../src/deno/index.ts"],"sourcesContent":["import { FontSplitProps } from '../interface.js';\nimport { getBinName, matchPlatform } from '../load.js';\nimport { createAPI } from '../createAPI.js';\nexport * from '../interface.js';\nexport * from '../createAPI.js';\n/** @ts-ignore */\nconst _Deno = Deno;\nlet binPath = _Deno.env.get('CN_FONT_SPLIT_BIN');\nif (!binPath) {\n    binPath = new URL(\n        '../' +\n            getBinName(\n                matchPlatform(process.platform, process.arch, () => false),\n            ),\n        import.meta.url,\n    );\n    // throw new Error('CN_FONT_SPLIT_BIN is undefined!');\n}\nconst dylib = _Deno.dlopen(binPath, {\n    font_split: { parameters: ['buffer', 'usize', 'function'], result: 'void' },\n} as const);\nconst createCallback = (cb: (data: Uint8Array) => void) =>\n    new _Deno.UnsafeCallback(\n        {\n            parameters: ['pointer', 'usize'],\n            result: 'void',\n        } as const,\n        (success: any, length: number) => {\n            let buffer = new _Deno.UnsafePointerView(success).getArrayBuffer(\n                Number(length),\n            );\n            cb(new Uint8Array(buffer.slice()));\n        },\n    ).pointer;\n\nexport const fontSplit = createAPI(dylib.symbols.font_split, createCallback);\n"],"names":["_Deno","binPath","getBinName","matchPlatform","_documentCurrentScript","dylib","createCallback","cb","success","length","buffer","fontSplit","createAPI"],"mappings":"gQAMA,MAAMA,EAAQ,KACd,IAAIC,EAAUD,EAAM,IAAI,IAAI,mBAAmB,EAC1CC,IACDA,EAAU,IAAI,IACV,MACIC,EAAAA,WACIC,EAAAA,cAAc,QAAQ,SAAU,QAAQ,KAAM,IAAM,EAAK,CAAA,EAEjE,OAAA,SAAA,IAAA,QAAA,KAAA,EAAA,cAAA,UAAA,EAAA,KAAAC,GAAAA,EAAA,QAAA,YAAA,IAAA,UAAAA,EAAA,KAAA,IAAA,IAAA,gBAAA,SAAA,OAAA,EAAA,IAAY,GAIpB,MAAMC,EAAQL,EAAM,OAAOC,EAAS,CAChC,WAAY,CAAE,WAAY,CAAC,SAAU,QAAS,UAAU,EAAG,OAAQ,MAAA,CACvE,CAAU,EACJK,EAAkBC,GACpB,IAAIP,EAAM,eACN,CACI,WAAY,CAAC,UAAW,OAAO,EAC/B,OAAQ,MAAA,EAEZ,CAACQ,EAAcC,IAAmB,CAC9B,IAAIC,EAAS,IAAIV,EAAM,kBAAkBQ,CAAO,EAAE,eAC9C,OAAOC,CAAM,CAAA,EAEjBF,EAAG,IAAI,WAAWG,EAAO,MAAA,CAAO,CAAC,CACrC,CACJ,EAAE,QAEOC,EAAYC,EAAAA,UAAUP,EAAM,QAAQ,WAAYC,CAAc"}